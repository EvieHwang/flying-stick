# Evaluation Criteria Configuration
#
# This file defines evaluation criteria for AI agents in the application.
# Each criterion is evaluated against traces to measure agent performance.
#
# Structure:
#   version: Config version (for future compatibility)
#   global_criteria: Applied to all agents
#   agents:
#     agent_name:
#       description: What this agent does
#       criteria: List of criteria specific to this agent
#
# Criterion fields:
#   name: Unique identifier
#   pillar: effectiveness | efficiency | reliability | trustworthiness
#   layer: 1 (binary gate) | 2 (quantitative) | 3 (human judgment)
#   signal: What to measure (field path or built-in signal name)
#   threshold: Pass condition
#   warning: Warning threshold (Layer 2 only)
#   enabled: true/false (default: true)
#
# Built-in signals:
#   - duration_ms: Response time in milliseconds
#   - input_tokens: Number of input tokens
#   - output_tokens: Number of output tokens
#   - total_tokens: Sum of input + output tokens
#   - error: Error message (null if no error)
#   - response.format: JSON validation result
#   - tool_count: Number of tool calls
#   - has_error: Boolean if error occurred
#   - response_length: Character count of response
#   - tokens_per_second: Output throughput

version: "1.0"

# Global criteria applied to all agents
global_criteria:
  # Layer 1: Binary Gates (must pass)
  - name: no_errors
    description: "Request must complete without errors"
    pillar: effectiveness
    layer: 1
    signal: error
    threshold: "must be null"

  # Layer 2: Quantitative Metrics
  - name: latency
    description: "Response time should be under 5 seconds"
    pillar: efficiency
    layer: 2
    signal: duration_ms
    threshold: "< 5000"
    warning: "< 3000"

  - name: token_efficiency
    description: "Total tokens should be reasonable"
    pillar: efficiency
    layer: 2
    signal: total_tokens
    threshold: "< 10000"
    warning: "< 5000"

# Agent-specific criteria
agents:
  # Example: Classification agent
  classifier:
    description: "Product classification agent that categorizes items"
    criteria:
      # Layer 1: Must return valid JSON with required fields
      - name: valid_json_output
        description: "Output must be valid JSON"
        pillar: effectiveness
        layer: 1
        signal: response.format
        threshold: "must be valid JSON"

      - name: has_category_field
        description: "Output must contain category field"
        pillar: effectiveness
        layer: 1
        signal: response.format
        threshold: "must have field 'category'"

      # Layer 2: Latency stricter for classification
      - name: classifier_latency
        description: "Classification should be fast"
        pillar: efficiency
        layer: 2
        signal: duration_ms
        threshold: "< 3000"
        warning: "< 2000"

      # Layer 3: Placeholder for LLM-as-Judge (disabled by default)
      - name: reasoning_quality
        description: "Quality of classification reasoning"
        pillar: trustworthiness
        layer: 3
        signal: response.output
        threshold: "mean >= 4"
        evaluation_method: llm_as_judge
        prompt: |
          Rate the quality of this classification reasoning on a scale of 1-5:
          1 = No reasoning or completely wrong
          2 = Weak reasoning with major gaps
          3 = Adequate reasoning
          4 = Good reasoning with minor gaps
          5 = Excellent, thorough reasoning
        sample_rate: 0.1
        enabled: false  # Disabled until Phase 4

  # Example: Summarization agent
  summarizer:
    description: "Text summarization agent"
    criteria:
      - name: output_not_empty
        description: "Summary must not be empty"
        pillar: effectiveness
        layer: 1
        signal: response_length
        threshold: "must not be empty"

      - name: reasonable_length
        description: "Summary should be concise"
        pillar: efficiency
        layer: 2
        signal: response_length
        threshold: "< 2000"
        warning: "< 1000"

  # Default agent (fallback if agent name not matched)
  default:
    description: "Default evaluation criteria for unspecified agents"
    criteria: []
